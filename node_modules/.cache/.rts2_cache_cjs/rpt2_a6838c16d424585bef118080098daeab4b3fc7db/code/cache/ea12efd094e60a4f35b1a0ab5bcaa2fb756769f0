{"code":"import React, { Component } from 'react';\r\nconst defaultPace = 40;\r\nconst defaultPause = 0;\r\nconst spanStyle = {\r\n    display: 'inline-block'\r\n};\r\nexport default class Text extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.str = (this.props.children || '').replaceAll(' ', '\\xa0');\r\n    }\r\n    componentDidMount() {\r\n        if (!this.props.parent) {\r\n            this.init();\r\n            this.run();\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        clearInterval(this.interval);\r\n    }\r\n    init() {\r\n        this.iteration = !this.props.rewind || this.props.parent?.props.rewind ? 0 : this.str.length - 1;\r\n        this.stopped = false;\r\n        this.setState({\r\n            display: null\r\n        });\r\n        this.onStart();\r\n    }\r\n    run() {\r\n        const pause = this.props.pause || this.props.parent?.props.pause || defaultPause;\r\n        setTimeout(() => {\r\n            this.updateInterval();\r\n        }, pause);\r\n    }\r\n    updateInterval() {\r\n        clearInterval(this.interval);\r\n        let pace = this.str[this.iteration] != '\\xa0'\r\n            ? this.props.pace || this.props.parent?.props.pace || defaultPace\r\n            : (this.props.whiteSpacePace || this.props.parent?.props.whiteSpacePace || this.props.pace || defaultPace);\r\n        this.interval = setInterval(() => this.play(), pace);\r\n    }\r\n    checkForWhiteSpace() {\r\n        if (this.str[this.iteration] == '\\xa0' && this.lastChar != '\\xa0') {\r\n            this.updateInterval();\r\n        }\r\n        else if (this.str[this.iteration] != '\\xa0' && this.lastChar == '\\xa0') {\r\n            this.updateInterval();\r\n        }\r\n        this.lastChar = this.str[this.iteration];\r\n    }\r\n    play() {\r\n        this.checkForWhiteSpace();\r\n        if (!this.stopped) {\r\n            const stamp = this.props.stamp || this.props.parent?.props.stamp;\r\n            const rewind = this.props.rewind || this.props.parent?.props.rewind;\r\n            if (!stamp) {\r\n                const chars = this.str.substr(0, this.iteration + 1).split('');\r\n                let display;\r\n                if (rewind) {\r\n                    display = chars.map((char, i) => {\r\n                        const style = {\r\n                            display: 'inline-block',\r\n                            animation: 'none'\r\n                        };\r\n                        return React.createElement(\"span\", { className: this.props.charClassName, style: style, key: i }, char);\r\n                    });\r\n                    display.pop();\r\n                    display.push(React.createElement(\"span\", { style: spanStyle, className: this.props.charClassName, key: Date.now() }, chars.slice(-1)));\r\n                }\r\n                else {\r\n                    display = chars.map((char, i) => {\r\n                        return React.createElement(\"span\", { style: spanStyle, className: this.props.charClassName, key: i }, char);\r\n                    });\r\n                }\r\n                this.setState({ display }, () => {\r\n                    this.iteration += rewind ? -1 : 1;\r\n                    if ((rewind && this.iteration < -1) ||\r\n                        (!rewind && this.iteration > this.str.length)) {\r\n                        this.stop();\r\n                    }\r\n                    else {\r\n                        this.onChar();\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                this.setState({\r\n                    display: React.createElement(\"span\", { style: spanStyle, className: this.props.charClassName, key: Date.now() }, this.str)\r\n                }, () => {\r\n                    this.iteration = rewind ? 0 : this.props.children.length - 1;\r\n                    this.onChar();\r\n                    this.stop();\r\n                });\r\n            }\r\n        }\r\n    }\r\n    replay() {\r\n        this.init();\r\n        this.run();\r\n    }\r\n    show() {\r\n        this.setState({\r\n            display: this.str.split('').map((char, i) => React.createElement(\"span\", { style: spanStyle, key: i }, char))\r\n        });\r\n    }\r\n    stop() {\r\n        if (this.props.loop) {\r\n            this.replay();\r\n        }\r\n        else {\r\n            this.stopped = true;\r\n            this.onStop();\r\n        }\r\n    }\r\n    onStart() {\r\n        this.props.onStart?.(this);\r\n    }\r\n    onChar() {\r\n        const rewind = this.props.parent?.props.rewind || this.props.rewind;\r\n        const char = rewind\r\n            ? this.str[this.iteration + 1]\r\n            : this.str[this.iteration - 1];\r\n        this.props.onChar?.(char, this);\r\n        this.props.parent?.props.onChar?.(char, this.props.parent);\r\n    }\r\n    onStop() {\r\n        clearInterval(this.interval);\r\n        this.props.onStop?.(this);\r\n        this.props?.parent?.play();\r\n    }\r\n    render() {\r\n        return React.createElement(\"div\", { className: this.props.className, style: {\r\n                display: this.props.block ? 'block' : 'inline-block'\r\n            } }, this.state?.display || '\\u00a0');\r\n    }\r\n}\r\n","references":["/home/vivien/Bureau/dev/node/typo/node_modules/@types/react/index.d.ts","/home/vivien/Bureau/dev/node/typo/src/typo.tsx"],"dts":{"name":"/home/vivien/Bureau/dev/node/typo/text.d.ts","writeByteOrderMark":false,"text":"import { Component } from 'react';\r\nimport Typo from './typo';\r\ninterface Props {\r\n    /** The pace between two chars in milliseconds. Default is 40 */\r\n    pace?: number;\r\n    /** The pace of white spaces to make the text more dynamic */\r\n    whiteSpacePace?: number;\r\n    /** The pause before starting the text in milliseconds. Default is 0 */\r\n    pause?: number;\r\n    /** Defines if the container css display rule is 'block' or 'inline-block'. Default is false */\r\n    block?: boolean;\r\n    /** Displays all the chars at once */\r\n    stamp?: boolean;\r\n    /** Prints the chars in the Text backwards */\r\n    rewind?: boolean;\r\n    /** Loops the animation */\r\n    loop?: boolean;\r\n    /** The Typo controller. Is automatically defined when a Text is in a Typo */\r\n    parent?: Typo;\r\n    /** The className assigned to every printed char */\r\n    charClassName?: string;\r\n    /** The className assigned to every white space char */\r\n    whiteSpaceClassName?: string;\r\n    /** The className of the Text container */\r\n    className?: string;\r\n    /**\r\n     * Called when the first char is printed\r\n     * @param text The current Text component\r\n     * */\r\n    onStart?: (text: Text) => void;\r\n    /**\r\n     * Called when a char is printed\r\n     * @param char The current printed char\r\n     * @param text The current Text component\r\n     * */\r\n    onChar?: (char: string, text: Text) => void;\r\n    /**\r\n     * Called when the last char is printed\r\n     * @param text The current Text component\r\n     * */\r\n    onStop?: (text: Text) => void;\r\n}\r\ninterface State {\r\n    display: JSX.Element[] | JSX.Element | null;\r\n}\r\nexport default class Text extends Component<Props, State> {\r\n    private stopped;\r\n    private interval;\r\n    str: string;\r\n    iteration: number;\r\n    lastChar: string;\r\n    constructor(props: Props);\r\n    componentDidMount(): void;\r\n    componentWillUnmount(): void;\r\n    init(): void;\r\n    run(): void;\r\n    updateInterval(): void;\r\n    checkForWhiteSpace(): void;\r\n    play(): void;\r\n    replay(): void;\r\n    show(): void;\r\n    stop(): void;\r\n    onStart(): void;\r\n    onChar(): void;\r\n    onStop(): void;\r\n    render(): JSX.Element;\r\n}\r\nexport {};\r\n"}}
