{"code":"import React, { Component } from 'react';\r\nimport Text from './text';\r\nexport default class Typo extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.textRefs = [];\r\n        this.init();\r\n    }\r\n    static play(typoName) {\r\n        Typo.typos.get(typoName)?.replay();\r\n    }\r\n    static stop(typoName) {\r\n        Typo.typos.get(typoName)?.stop();\r\n    }\r\n    componentDidMount() {\r\n        if (!this.props.stop) {\r\n            //si le typo est dans le next d'un autre, on ne lance pas play sauf s'il est first\r\n            if (!Array.from(Typo.typos.values()).some(typo => typo.props.next == this.name) || Typo.first == this) {\r\n                this.init();\r\n                this.play();\r\n            }\r\n        }\r\n    }\r\n    init() {\r\n        this.initiated = false;\r\n        this.textRefs.forEach(text => text.current?.init());\r\n        this.texts = React.Children.map(this.props.children, child => {\r\n            let ref = React.createRef();\r\n            this.textRefs.push(ref);\r\n            return React.createElement(Text, Object.assign({}, child.props, { ref: ref, parent: this, rewind: this.props.rewind || child.props.rewind }), child.props.children || '');\r\n        });\r\n        this.iteration = !this.props.rewind ? 0 : this.texts.length == 1 ? 0 : this.texts.length - 1;\r\n        this.name = this.props.name || '_' + Math.random().toString(36).substr(2, 9);\r\n        Typo.typos.set(this.name, this);\r\n        if (typeof Typo.first == 'undefined') {\r\n            Typo.first = this;\r\n        }\r\n    }\r\n    play() {\r\n        if (!this.initiated) {\r\n            this.onStart();\r\n            this.initiated = true;\r\n        }\r\n        if ((this.props.rewind && this.iteration < 0) || (!this.props.rewind && this.iteration > this.texts.length - 1)) {\r\n            this.stop();\r\n        }\r\n        else {\r\n            if (this.props.rewind) {\r\n                for (let i = this.iteration; i >= 0; i--) {\r\n                    this.textRefs[i].current?.show();\r\n                }\r\n            }\r\n            this.textRefs[this.iteration]?.current?.init();\r\n            this.textRefs[this.iteration]?.current?.run();\r\n            this.iteration += this.props.rewind ? -1 : 1;\r\n            this.onText();\r\n        }\r\n    }\r\n    replay() {\r\n        this.init();\r\n        this.play();\r\n    }\r\n    stop() {\r\n        this.onStop();\r\n    }\r\n    onStart() {\r\n        this.props.onStart?.(this);\r\n    }\r\n    onText() {\r\n        const text = this.props.rewind\r\n            ? this.textRefs[this.iteration + 1]?.current\r\n            : this.textRefs[this.iteration - 1]?.current;\r\n        if (text) {\r\n            this.props.onText?.(text, this);\r\n        }\r\n    }\r\n    //on lance le event handler onStop et on lance le play du prochain Typo\r\n    onStop() {\r\n        this.props.onStop?.(this);\r\n        if (this.props.next) {\r\n            Typo.typos.get(this.props.next)?.play();\r\n        }\r\n    }\r\n    render() {\r\n        return React.createElement(\"div\", { className: this.props.className, style: { display: 'inline-block' } }, this.texts);\r\n    }\r\n}\r\nTypo.typos = new Map();\r\n","references":["/home/vivien/Bureau/dev/node/typo/node_modules/@types/react/index.d.ts","/home/vivien/Bureau/dev/node/typo/src/text.tsx"],"dts":{"name":"/home/vivien/Bureau/dev/node/typo/typo.d.ts","writeByteOrderMark":false,"text":"import React, { Component } from 'react';\r\nimport Text from './text';\r\ninterface Props {\r\n    /** Prevents the typo from playing */\r\n    stop?: boolean;\r\n    /** Defines this typo as being the first to execute when this typo's name is in the 'next' prop of another typo */\r\n    first?: boolean;\r\n    /** Prints the chars in the Texts backwards */\r\n    rewind?: boolean;\r\n    /** Displays all the chars in the Texts at once */\r\n    stamp?: boolean;\r\n    /** The pause before starting the text in milliseconds. Default is 0 */\r\n    pause?: number;\r\n    /** The pace between two chars in milliseconds. Default is 40 */\r\n    pace?: number;\r\n    /** The pace of white spaces to make the text more dynamic */\r\n    whiteSpacePace?: number;\r\n    /** The name of the next Typo to render */\r\n    next?: string;\r\n    /** the name of the typo */\r\n    name?: string;\r\n    /** the className of the typo container */\r\n    className?: string;\r\n    /**\r\n     * Called when the component is mounted\r\n     * @param typo The current Typo component\r\n     * */\r\n    onStart?: (typo: Typo) => void;\r\n    /**\r\n    * Called when the current Text component is mounted\r\n    * @param text The current Text component\r\n    * @param typo The current Typo component\r\n    * */\r\n    onText?: (text: Text, typo: Typo) => void;\r\n    /**\r\n     * Called when the last char in the last Text is printed\r\n     * @param typo The current Typo component\r\n     * */\r\n    onStop?: (typo: Typo) => void;\r\n    /**\r\n     * Called when a char is printed\r\n     * @param char The current printed char\r\n     * @param typo The current Typo component\r\n     * */\r\n    onChar?: (char: string, typo: Typo) => void;\r\n}\r\ninterface State {\r\n    display: JSX.Element[] | JSX.Element;\r\n}\r\nexport default class Typo extends Component<Props, State> {\r\n    private static typos;\r\n    private static first;\r\n    static play(typoName: string): void;\r\n    static stop(typoName: string): void;\r\n    private initiated;\r\n    name: string;\r\n    texts: JSX.Element[];\r\n    textRefs: React.RefObject<Text>[];\r\n    iteration: number;\r\n    constructor(props: Props);\r\n    componentDidMount(): void;\r\n    init(): void;\r\n    play(): void;\r\n    replay(): void;\r\n    stop(): void;\r\n    onStart(): void;\r\n    onText(): void;\r\n    onStop(): void;\r\n    render(): JSX.Element;\r\n}\r\nexport {};\r\n"}}
